<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{admin/layout/admin-base}">
<head><title>Редактирование статьи</title></head>
<body>
<main layout:fragment="content">
    <h1 th:text="${article != null} ? 'Редактирование' : 'Новая статья'">Статья</h1>
    <div th:if="${article != null}" style="margin-bottom:1rem;color:var(--muted,#888);">
        <span>Просмотры: <strong th:text="${article.viewCount}">0</strong></span> &middot;
        <span>Версия: <strong th:text="${article.version}">1</strong></span> &middot;
        <a th:href="@{/admin/articles/{id}/revisions(id=${article.id})}">История ревизий</a>
    </div>
    <form th:action="${article != null} ? @{/admin/articles/{id}/edit(id=${article.id})} : @{/admin/articles/new}"
          method="post" th:object="${form}">
        <div>
            <label>Заголовок</label>
            <input type="text" th:field="*{title}" required style="width:100%;padding:0.5rem;">
        </div>
        <div style="margin-top:1rem;">
            <label>Контент</label>
            <textarea id="content" th:field="*{content}"></textarea>
        </div>
        <div style="margin-top:1rem;">
            <label>Краткое описание</label>
            <textarea th:field="*{excerpt}" rows="3" style="width:100%;padding:0.5rem;"></textarea>
        </div>
        <div style="margin-top:1rem;">
            <label>URL обложки</label>
            <input type="text" th:field="*{coverImageUrl}" style="width:100%;padding:0.5rem;">
        </div>
        <div style="margin-top:1rem;">
            <label>SEO заголовок</label>
            <input type="text" th:field="*{seoTitle}" style="width:100%;padding:0.5rem;">
        </div>
        <div style="margin-top:1rem;">
            <label>SEO описание</label>
            <textarea th:field="*{seoDescription}" rows="2" style="width:100%;padding:0.5rem;"></textarea>
        </div>
        <div style="margin-top:1rem;">
            <label>Теги</label>
            <select th:field="*{tagIds}" multiple style="width:100%;min-height:80px;">
                <option th:each="tag : ${tags}" th:value="${tag.id}" th:text="${tag.name}"></option>
            </select>
        </div>
        <div style="margin-top:1rem;display:flex;gap:1rem;">
            <div style="flex:1">
                <label>Приоритет</label>
                <input type="number" th:field="*{priority}" style="width:100%;padding:0.5rem;">
            </div>
            <div style="flex:1">
                <label>Язык</label>
                <select th:field="*{locale}" style="width:100%;padding:0.5rem;">
                    <option value="ru">Русский</option>
                    <option value="en">English</option>
                </select>
            </div>
        </div>
        <div style="margin-top:1rem;">
            <label><input type="checkbox" th:field="*{publish}"> Опубликовать</label>
        </div>
        <button type="submit" style="margin-top:1rem;padding:0.5rem 2rem;">Сохранить</button>
    </form>
    <script src="https://cdn.jsdelivr.net/npm/tinymce@6/tinymce.min.js"></script>
    <script>
        tinymce.init({
            selector: '#content',
            height: 500,
            plugins: 'image code codesample link lists',
            toolbar: 'undo redo | blocks | bold italic | link image codesample | bullist numlist',
            images_upload_url: '/admin/media/upload',
            promotion: false,
            branding: false
        });
    </script>
</main>
</body>
</html>
